 <!DOCTYPE html>
<html>
<body>
<script src="repeatscore_ems.js"></script>

<script>

function write_1d_int32_array(ptr,array) {

  for(i=0;i<array.length;i++) {
    Module.setValue(ptr,array[i],'i32');
    ptr += 4;
  }

}

function read_1d_int32_array(ptr,length) {

  var array = [];

  for(i=0;i<length;i++) {
    var value = Module.getValue(ptr+(i*4),'i32');
    array.push(value);
  }

  return array;
}

// test1 - a C function that takes, and returns a C style string (char *)

var mystring = "testtestestestestestsetestetstes";
var strptr = Module._malloc(mystring.length);
Module.writeAsciiToMemory(mystring, strptr);

var retarrayptr = Module.ccall('repeat_score', // name of C function
  'number', // return type
  ['number'], // argument types
  [strptr]); // arguments

// Convert the resulting pointer to a JS array
var retarray = read_1d_int32_array(retarrayptr,myarray.length);
document.write(retarray);

</script>


</body>
</html>
